<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1.0">
	<title>CFIW Map</title>
	<link href='css/style.css' rel='stylesheet' type='text/css'/>
	<link href='css/headerStyle.css' rel='stylesheet' type='text/css'/>
	<!--<link href='css/map-styles.css' rel='stylesheet' type='text/css'/>-->
	<!--ion Range Slider Plugin CSS file with desired skin-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/css/ion.rangeSlider.min.css"/>
    <!--jQuery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!--ion Range Slider Plugin JavaScript file-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/js/ion.rangeSlider.min.js"></script>
    <style>
    	/* Style the page */

		body {
			margin: 0px;
			padding: 0px;
			box-sizing: border-box;
		}

		button {
			border: none;
			outline: none;
			border-radius: 3px;
			padding: 3px;
			font-weight: 500;
		}

		#footprint-button {
			/*color: var(--dark-text);
			background-color: rgb(34,34,34);*/
		}

		#footprint-button:hover {
			color: var(--background);
			background-color: #ff4081;
		}

		#footprint-button:active {
			color: black;
			background-color: #E2326D;
		}


		#hide-disinfections,
		#show-disinfections {
			
		}

		#hide-disinfections:hover,
		#show-disinfections:hover {
			color: var(--background);
			background-color:  #6242ff;
		}

		#hide-disinfections:active,
		#show-disinfections:active {
			color: black;
			background-color:  #5238D2;
		}

		#hide-chinese-hospitals,
		#show-chinese-hospitals {
			
		}

		#hide-chinese-hospitals:hover,
		#show-chinese-hospitals:hover {
			color: var(--background);
			background-color: #ffe94b;
		}

		#hide-chinese-hospitals:active,
		#show-chinese-hospitals:active {
			color: black;
			background-color: #D7C73D;
		}

		#hide-english-hospitals,
		#show-english-hospitals {
			
		}

		#hide-english-hospitals:hover,
		#show-english-hospitals:hover {
			color: var(--background);
			background-color: #1de9b6;
		}

		#hide-english-hospitals:active,
		#show-english-hospitals:active {
			color: black;
			background-color: #1CD0A6;
		}

		#page-header {
			text-align: center;
			margin: 20px 0;
		}

		/* Style the map */

		#map {
			position: relative;
			height: 400px;
			width: 80%;
			margin: 20px auto;
		}

		/* Style the controls containers */

		.controls-container {
			position: relative;
			margin: 20px auto;
			width: 80%;
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			align-items: top;
		}

		.container {
			width: 40%;
			margin: 10px 20px;
		}

		/* Style the Footprint controls */

		.extra-controls {
			display: flex;
			justify-content: center;
		}

		.js-input {
			width: 50%;
		}

		/* Style the Disinfection/Vaccination/Hospital controls */

		.category-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.other-control-label {
			width: 70%;
		}

		.hide-show-controls {
			width: 30%;
			display: flex;
			justify-content: center;
		}

		.hide-show-button {
			width: 50%;
		}

		@media all and (max-width: 751px) {

			.container {
				width: 100%;
			}
		}
    </style>
</head>
<body>
	<header>
		<h1 class='logo'>Covid Taichung</h1>
		<input type='checkbox' id='nav-toggle' class='nav-toggle'>
		<nav class='nav'>
			<ul>
				<li><a href='index.html'>Footprints</a></li>
				<li><a href='map.html'>Map</a></li>
				<li><a href='faq.html'>FAQ</a></li>
				<li><a href='stats.html'>Stats</a></li>
				<li><a href='contact.html'>Contact</a></li>
			</ul>
		</nav>
		<label for='nav-toggle' class='nav-toggle-label'>
			<span></span>
		</label>
	</header>
	<section>
		<h1 id="page-header">This is the map</h1>
		<div class="controls-container">
			<div id="footprint-controls-container" class="container">
				<label>Footprint Locations</label>
				<button id="footprint-button" class="footprints-pressed">Hide footprints</button>
				<div class="range-slider">
			    <input type="text" class="js-range-slider" value="" />
				</div>
				<div class="extra-controls">
				    <input type="text" class="js-input-from js-input" value="0" />
				    <input type="text" class="js-input-to js-input" value="0" />
				</div>
			</div>
			<div id="other-controls-container" class="container">
				<div class="category-container">
					<label class="other-control-label">Disinfection Locations</label>
					<div class="hide-show-controls">
						<button id="hide-disinfections" class="hide-show-button">Hide</button>
						<button id="show-disinfections" class="hide-show-button">Show</button>
					</div>
				</div>
				<div class="category-container">
					<label class="other-control-label">Chinese Hospitals</label>
					<div class="hide-show-controls">
						<button id="hide-chinese-hospitals" class="hide-show-button">Hide</button>
						<button id="show-chinese-hospitals" class="hide-show-button">Show</button>
					</div>
				</div>
				<div class="category-container">
					<label class="other-control-label">English Hospitals 
						<i></i>
						</label>

					<div class="hide-show-controls">
						<button id="hide-english-hospitals" class="hide-show-button">Hide</button>
						<button id="show-english-hospitals" class="hide-show-button">Show</button>
					</div>
				</div>
				<div class="category-container">
					<label class="other-control-label">Vaccination Stations</label>
					<div class="hide-show-controls">
						<button id="hide-vaccination-stations" class="hide-show-button">Hide</button>
						<button id="show-vaccination-stations" class="hide-show-button">Show</button>
					</div>
				</div>
			</div>
		</div>
		<div id="map"></div>
	</section>
	<script src="js/map/map-functions.js"></script>
	<script src="js/map/map-marker-toggles.js"></script>
	<script>
		//if I make this one big function
		//and then call if after the footprint function
		//and the map function
		//then... it will wait until footprint data is in
		//and use it...?
			//I think I can add a new sliderDatesArray
			//and in that push all unique date values
			//so I'd get a new array, with hopefully one index
			//for each date value. let's try..
		function initializeSlider() {
			var $range = $(".js-range-slider"),
		    $inputFrom = $(".js-input-from"),
		    $inputTo = $(".js-input-to"),
		    instance,
		    min = 0,
		    max = sliderDatesArray.length-1,
		    from = 0,
		    to = 0;

			$range.ionRangeSlider({
			    skin: "round",
			    type: "double",
			    min: min,
			    max: max,
			    from: sliderDatesArray.length-3,
			    to: sliderDatesArray.length-1,
			    //from: my_from,
			    //to: my_to,
			    values: sliderDatesArray,
			    onStart: updateInputs,
			    onChange: updateInputs
			});

			instance = $range.data("ionRangeSlider");

			function updateInputs (data) {
			    from = data.from;
			    to = data.to;
			    $inputFrom.prop("value", from);
			    $inputTo.prop("value", to);
			    //console.log(`The oldest should should be from: ${from}`)
			    //console.log(`${sliderDatesArray[from]}`)
			    showSliderMarkers(from, to)
			}

			//function to match slider FROM/MIN with user input
			$inputFrom.on("input", function () {
			    var val = $(this).prop("value");
			    
			    // validate
			    if (val < min) {
			        val = min;
			    } else if (val > to) {
			        val = to;
			    }
			    
			    instance.update({
			        from: val
			    });
			});

			//function to match slider TO/MAX with user input
			$inputTo.on("input", function () {
			    var val = $(this).prop("value");
			    
			    // validate
			    if (val < from) {
			        val = from;
			    } else if (val > max) {
			        val = max;
			    }
			    
			    instance.update({
			        to: val
			    });
			});
		}	
		
	</script>
	<script async
	    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCqOe9fM_PP7kzC-cqh9IiMogQKRlNFYWQ&callback=initMap">
	</script>
	<script src="js/map/map-fetch-scripts.js"></script>
</body>
</html>

<!--
This is the old code for the google map request with the call back built into the script. I have moved the initMap call to be after the Fetch request is succesful.
<script async
	    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCqOe9fM_PP7kzC-cqh9IiMogQKRlNFYWQ&callback=initMap">
	</script>
-->
